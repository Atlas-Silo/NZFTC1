@page
@model NZFTC.Server.Pages.Grievances.MyCasesModel
@{
    ViewData["PageTitle"] = "My Grievance Cases";
}

@section Styles {
    <link rel="stylesheet" href="~/css/grievances.css" asp-append-version="true" />
}

<div class="layout">
    <partial name="_EmployeeSidebar" />
    
    <div class="main-content">
        <partial name="_Topbar" />
        
        <main class="content">
            <div class="page-header">
                <div class="page-header-left">
                    <h2>My Grievance Cases</h2>
                    <p>View and track your submitted grievances</p>
                </div>
                <a asp-page="Submit" class="btn-submit">Submit New Grievance</a>
            </div>

            @* Stats Bar *@
            @*<div class="stats-bar">
                <div class="stat-card">
                    <h3>Total Cases</h3>
                    <div class="stat-value">@Model.TotalCases</div>
                </div>
                <div class="stat-card warning">
                    <h3>Active Cases</h3>
                    <div class="stat-value">@Model.ActiveCases</div>
                </div>
                <div class="stat-card success">
                    <h3>Resolved Cases</h3>
                    <div class="stat-value">@Model.ResolvedCases</div>
                </div>
            </div>*@

            @* Info*@
            <div class="info-box">
                <p><strong>Confidential:</strong> You will receive updates as your case progresses.</p>
            </div>

            @* Cases  *@
            <div class="cases-grid">
                @foreach (var grievance in Model.Grievances)
                {
                    <div class="case-card" onclick="window.location.href='@Url.Page("PerCase", new { id = grievance.Id })'">
                        <div class="case-header">

                            <div>
                                @*<div class="case-id">@grievance.CaseId</div>*@
                                <div class="case-id">GRV-@grievance.Id</div>
                                <div class="case-date">Submitted: @grievance.SubmittedOn.ToString("MMMM dd, yyyy")</div>
                            </div>

                            <div class="case-badges">
                                @*<span class="badge @grievance.Priority.ToLower()">@grievance.Priority</span>*@
                                <span class="badge @grievance.Status.ToLower()">@grievance.Status</span>
                            </div>
                        </div>

                        <div class="case-body">
                            @*<div class="category-badge">@grievance.Category</div>*@
                            <div class="case-subject">@grievance.Subject</div>
                            <div class="case-description">@grievance.Details</div>
                        </div>

                        <div class="case-footer">
                            @*<div class="case-info">
                                <div class="case-info-item">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                                    </svg>
                                    @(grievance.AssignedTo ?? "Unassigned")
                                </div>

                                <div class="case-info-item">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                        <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                                    </svg>

                                    @grievance.DaysAgo
                                </div>
                                @if (grievance.UpdateCount > 0)
                                {
                                    <div class="case-info-item">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                            <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
                                        </svg>
                                        @grievance.UpdateCount updates
                                    </div>
                                }
                            </div>*@
                            
                            <div class="case-actions">
                                <a asp-page="PerCase" asp-route-id="@grievance.Id" class="btn-view" onclick="event.stopPropagation()">View Details</a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </main>
    </div>
</div>

@* Supposed to display all greviences per user ID, all current employee greviences*@